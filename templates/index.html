<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Face Dataset Generator</title>
    <style>
        #video-container {
            position: relative;
            display: inline-block;
        }

        #video {
            transform: scaleX(-1);  /* Flip the video horizontally for a more natural appearance */
        }

        #enrolmentForm {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Face Dataset Generator</h1>
    
    <div id="video-container">
        <video id="video" width="640" height="480" autoplay></video>
    </div>
    
    <form id="enrolmentForm">
        <label for="enrolment">Enter Enrolment ID:</label>
        <input type="text" id="enrolment" name="enrolment" required>
        <button type="button" onclick="startCamera()">Start Camera</button>
        <button type="button" onclick="startDataCollection()">Start Data Collection</button>
        <button type="button" onclick="closeCamera()">Close Camera</button>
    </form>
    
    <div id="status"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        var socket = io.connect('http://' + document.domain + ':' + location.port);
        var video = document.getElementById('video');
        var statusDiv = document.getElementById('status');
        var stream;

        function startCamera() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function (videoStream) {
                    stream = videoStream;
                    video.srcObject = stream;
                })
                .catch(function (err) {
                    console.error("Error accessing the camera: " + err);
                });
        }

        function startDataCollection() {
            var enrolment = document.getElementById('enrolment').value;
            socket.emit('enrolment', enrolment);
            statusDiv.innerHTML = 'Data collection in progress...';
        }

        function closeCamera() {
            if (stream) {
                var tracks = stream.getTracks();
                tracks.forEach(function(track) {
                    track.stop();
                });
                video.srcObject = null;
                statusDiv.innerHTML = 'Camera closed.';
            }
        }

        socket.on('message', function(msg) {
            statusDiv.innerHTML = msg;
        });
    </script>
</body>
</html>
